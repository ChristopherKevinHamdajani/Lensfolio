<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Edit Project</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link th:href="@{/styles/main.css}" rel="stylesheet" />
    <link th:href="@{/styles/form.css}" rel="stylesheet" />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
<div class="header">
    <div class="title">
        <div class="title-name">Edit Project</div>
    </div>
</div>
<div class="content">
<form th:action="@{/edit-project}"
      method="post">
    <label for="projectName">Project Name (Character Limit: 30)</label> <br/>
    <input id="projectName" type="text" th:name="projectName" th:value="*{projectName}" maxlength="30">
    <br/>
    <div class="horizontal-group">
    <div class="horizontal-group-element" >
        <label for="projectStartDate">Project Start Date</label> <br/>
        <input id="projectStartDate" type="text" th:name="projectStartDate" th:value="*{projectStartDate}" pattern="[0-9]{2}/(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)/[0-9]{4}">
    </div>
    <div class="horizontal-group-element" >
        <label for="projectEndDate">Project End Date</label> <br/>
        <input id="projectEndDate" type="text" th:name="projectEndDate" th:value="*{projectEndDate}" pattern="[0-9]{2}/(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)/[0-9]{4}">
    </div>
    </div>
    <span id="projectStartDateError" style="color:red" th:text="*{projectStartDateError}"></span>
    <div>
        <label for="projectDescription">Project Description (Character Limit: 1000)</label> <br/>
        <textarea class="description-input" id="projectDescription" th:name="projectDescription" th:text="*{projectDescription}" maxlength="150"></textarea>
    </div>
    <br/>
    <button class="cancel" type="button">
        <a th:href="@{'/details'}">Cancel</a>
    </button>
    <button id="saveButton" class="save" type="submit">Save</button>
</form>
</div>
</body>

<script>
    function updateProjectDateError() {
        const data = {
            projectStartDate: document.getElementById("projectStartDate").value,
            projectEndDate: document.getElementById("projectEndDate").value
        }
        $.post("edit-project/error?" + new URLSearchParams(data)).done(function (fragment) {
            console.log(fragment);
            $("#projectStartDateError").replaceWith(fragment);
            document.getElementById("saveButton").disabled = document.getElementById("projectStartDateError").textContent.length > 0;
        });
    }

    document.getElementById("projectStartDate").onkeyup = updateProjectDateError;
    document.getElementById("projectEndDate").onkeyup = updateProjectDateError;
</script>

</html>